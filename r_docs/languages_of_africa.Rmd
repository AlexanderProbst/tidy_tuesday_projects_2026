---
title: "Languages of Africa: A Data Analysis"
author: "Data Analysis Report"
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: flatly
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 6)
library(tidyverse)
library(scales)
library(viridis)

# Read the data
africa <- read_csv("../Data/africa_data.csv")
```

## Executive Summary

This report analyzes linguistic diversity across Africa using TidyTuesday data on African languages. The dataset contains **796 language-country observations** representing **502 unique languages** spoken across **51 African countries**, grouped into **17 language families**.

**Note on Data Structure**: Each row represents a language spoken in a specific country. Languages spoken in multiple countries appear multiple times in the dataset, which allows us to analyze cross-border linguistic connections.

Key findings include:

- **Extreme linguistic diversity**: Niger-Congo family dominates with 279 languages
- **Language endangerment**: 23% of languages have fewer than 10,000 speakers (UNESCO endangerment threshold)
- **Speaker concentration**: The top 10 languages account for 58% of all native speakers
- **Cross-border connections**: 155 languages (31%) are spoken across multiple countries, with Arabic spanning 12 nations

---

## Data Overview

```{r}
# Create summary of unique languages
languages_summary <- africa |>
  group_by(language, family) |>
  summarize(
    total_speakers = max(native_speakers),
    countries_count = n_distinct(country),
    .groups = "drop"
  )

# Calculate key statistics
total_languages <- n_distinct(africa$language)
total_families <- n_distinct(africa$family)
total_countries <- n_distinct(africa$country)
total_speakers <- sum(languages_summary$total_speakers)

cat("Dataset contains:\n")
cat("- Language-country pairs:", nrow(africa), "\n")
cat("- Unique languages:", total_languages, "\n")
cat("- Language families:", total_families, "\n")
cat("- Countries:", total_countries, "\n")
cat("- Total native speakers:", comma(total_speakers), "\n")
```

---

## Language Families: The Niger-Congo Dominance

The Niger-Congo family exhibits extraordinary diversity, containing more than half of all African languages in this dataset.

```{r}
# Language family summary
family_summary <- languages_summary |>
  group_by(family) |>
  summarize(
    n_languages = n(),
    total_speakers = sum(total_speakers),
    .groups = "drop"
  ) |>
  arrange(desc(n_languages))

# Combined visualization: languages AND speakers
family_summary_long <- family_summary |>
  filter(n_languages >= 4) |>
  pivot_longer(cols = c(n_languages, total_speakers), 
               names_to = "metric", 
               values_to = "value")

ggplot(family_summary_long, aes(x = reorder(family, n_languages), y = value, fill = metric)) +
  geom_col(position = "dodge") +
  coord_flip() +
  scale_fill_viridis_d(option = "plasma", begin = 0.3, end = 0.7,
                       labels = c("Number of Languages", "Total Speakers")) +
  scale_y_continuous(labels = comma) +
  labs(
    title = "Language Families: Diversity vs. Speaker Population",
    subtitle = "Families with 4+ languages",
    x = "Language Family",
    y = "Count",
    fill = "Metric"
  ) +
  theme_minimal()
```

**Key Finding**: Niger-Congo has `r family_summary$n_languages[1]` languages but Afro-Asiatic (with only `r family_summary$n_languages[family_summary$family == "Afro-Asiatic"]` languages) has `r comma(family_summary$total_speakers[family_summary$family == "Afro-Asiatic"])` speakers, driven largely by Arabic.

---

## Most Spoken Languages

```{r}
# Top 10 most spoken languages
top_languages <- languages_summary |>
  slice_max(total_speakers, n = 10)

# Calculate concentration
top10_speakers <- sum(top_languages$total_speakers)
concentration_pct <- round(100 * top10_speakers / total_speakers, 1)

ggplot(top_languages, aes(x = reorder(language, total_speakers), y = total_speakers, fill = total_speakers)) +
  geom_col() +
  coord_flip() +
  scale_y_continuous(labels = comma) +
  scale_fill_viridis_c(option = "viridis", direction = -1) +
  labs(
    title = "Top 10 Most Spoken African Languages",
    subtitle = paste0("These languages represent ", concentration_pct, "% of all native speakers in the dataset"),
    x = NULL,
    y = "Native Speakers",
    fill = "Speakers"
  ) +
  theme_minimal() +
  theme(legend.position = "none")
```

**Key Finding**: Arabic dominates with 150 million speakers, followed by Hausa (85M) and Swahili (53M). The top 10 languages account for **`r concentration_pct`%** of all speakers, showing significant concentration despite high linguistic diversity.

---

## Endangered Languages Crisis

Using UNESCO's threshold of 10,000 speakers to identify potentially endangered languages:

```{r}
# Endangered languages analysis
endangered <- languages_summary |>
  filter(total_speakers < 10000)

endangered_pct <- round(100 * nrow(endangered) / nrow(languages_summary), 1)

# Distribution of language sizes
size_distribution <- languages_summary |>
  mutate(size_category = case_when(
    total_speakers < 10000 ~ "Endangered (<10k)",
    total_speakers < 100000 ~ "Small (10k-100k)",
    total_speakers < 1000000 ~ "Medium (100k-1M)",
    TRUE ~ "Large (>1M)"
  )) |>
  count(size_category) |>
  mutate(
    size_category = factor(size_category, 
                          levels = c("Endangered (<10k)", 
                                    "Small (10k-100k)", 
                                    "Medium (100k-1M)", 
                                    "Large (>1M)")),
    pct = round(100 * n / sum(n), 1)
  )

ggplot(size_distribution, aes(x = size_category, y = n, fill = size_category)) +
  geom_col() +
  geom_text(aes(label = paste0(n, "\n(", pct, "%)")), vjust = -0.5, size = 4) +
  scale_fill_viridis_d(option = "magma", direction = -1) +
  labs(
    title = "Distribution of African Languages by Speaker Population",
    subtitle = "UNESCO considers languages with <10,000 speakers as potentially endangered",
    x = "Language Size Category",
    y = "Number of Languages"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "none"
  ) +
  ylim(0, max(size_distribution$n) * 1.15)
```

**Key Finding**: `r nrow(endangered)` languages (`r endangered_pct`% of all languages) have fewer than 10,000 speakers, putting them at risk of extinction. The median language has only `r comma(median(languages_summary$total_speakers))` speakers.

---

## Geographic Diversity: Linguistically Rich Countries

```{r}
# Country linguistic diversity
country_diversity <- africa |>
  group_by(country) |>
  summarize(
    n_languages = n_distinct(language),
    total_speakers = sum(native_speakers),
    n_families = n_distinct(family),
    .groups = "drop"
  ) |>
  arrange(desc(n_languages))

# Top 15 countries
top_countries <- country_diversity |>
  slice_max(n_languages, n = 15)

ggplot(top_countries, aes(x = reorder(country, n_languages), y = n_languages, fill = n_languages)) +
  geom_col() +
  coord_flip() +
  scale_fill_viridis_c(option = "mako", direction = -1) +
  labs(
    title = "Most Linguistically Diverse African Countries",
    subtitle = "Number of distinct languages per country",
    x = NULL,
    y = "Number of Languages",
    fill = "Languages"
  ) +
  theme_minimal() +
  theme(legend.position = "none")
```

**Key Finding**: Nigeria leads with `r max(country_diversity$n_languages)` languages, representing `r n_distinct(africa$family[africa$country == "Nigeria"])` different language families. This reflects the country's diverse ethnic composition and geography.

---

## Cross-Border Languages: Linguistic Bridges

Languages that transcend national boundaries often serve as regional lingua francas and trade languages.

```{r}
# Analyze cross-border languages
cross_border <- africa |>
  group_by(language, family) |>
  summarize(
    countries = n_distinct(country),
    speakers = max(native_speakers),
    .groups = "drop"
  ) |>
  filter(countries > 1) |>
  arrange(desc(countries))

cross_border_pct <- round(100 * nrow(cross_border) / total_languages, 1)

# Visualization of top cross-border languages
top_cross_border <- cross_border |>
  slice_max(countries, n = 15)

ggplot(top_cross_border, aes(x = reorder(language, countries), y = countries, fill = log10(speakers))) +
  geom_col() +
  coord_flip() +
  scale_fill_viridis_c(option = "turbo", labels = function(x) comma(10^x)) +
  labs(
    title = "Most Widespread Languages Across African Countries",
    subtitle = "Languages spoken in 5+ countries (color shows speaker population)",
    x = NULL,
    y = "Number of Countries",
    fill = "Speakers"
  ) +
  theme_minimal()
```

**Key Finding**: `r nrow(cross_border)` languages (`r cross_border_pct`% of all languages) are spoken across multiple countries. Arabic tops the list, spanning `r max(cross_border$countries)` nations, followed by Fulani (10 countries) and MoorÃ© (8 countries). These languages facilitate regional communication and trade.

```{r}
# Summary table
cross_border |>
  slice_max(countries, n = 10) |>
  select(Language = language, Family = family, Countries = countries, Speakers = speakers) |>
  mutate(Speakers = comma(Speakers)) |>
  knitr::kable(caption = "Top 10 Cross-Border Languages")
```

---

## Conclusion

This analysis reveals Africa's extraordinary linguistic landscape:

1. **High Diversity**: 502 languages across 17 families, with Niger-Congo representing 55% of all languages
2. **Concentration Risk**: Despite high diversity, the top 10 languages account for 58% of speakers, while 23% of languages are endangered
3. **Regional Integration**: Nearly one-third of languages cross national borders, facilitating regional communication
4. **Preservation Challenge**: `r nrow(endangered)` languages with fewer than 10,000 speakers face potential extinction without preservation efforts

The data underscores the need for language preservation initiatives, particularly for the `r endangered_pct`% of languages classified as endangered, while recognizing the practical importance of widespread regional languages for commerce and communication.